<script lang="ts">
import { Component, Vue } from 'vue-property-decorator';

import BuildingsTable from '~/components/BuildingsTable.vue';
import BuildingsHero from '~/components/BuildingsHero.vue';
import DataDisclaimer from '~/components/DataDisclaimer.vue';
import DataSourceFootnote from '~/components/DataSourceFootnote.vue';
import NewTabIcon from '~/components/NewTabIcon.vue';
import { generatePageMeta } from '../constants/meta-helpers.vue';

// TODO: Figure out a way to get metaInfo working without any
// https://github.com/xerebede/gridsome-starter-typescript/issues/37
@Component<any>({
  components: {
    BuildingsTable,
    BuildingsHero,
    DataDisclaimer,
    DataSourceFootnote,
    NewTabIcon,
  },
  metaInfo() {
    return generatePageMeta(
      'top-gas-users',
      'Top Fossil Gas Users',
      "Chicago's biggest consumers of fossil gas - these buildings represent " +
        'the largest opportunity for emissions reductions through electrification.',
    );
  },
})
export default class TopGasUsers extends Vue {}
</script>

<!-- If this query is updated, make sure to update PageSocialCard as well -->
<static-query>
  query {
    allBuilding(sortBy: "NaturalGasUse", limit: 50) {
      edges {
        node {
          slugSource
          ID
          DataYear
          PropertyName
          Address
          ZIPCode
          path
          PrimaryPropertyType
          GHGIntensity
          GHGIntensityRank
          GHGIntensityPercentileRank
          TotalGHGEmissions
          TotalGHGEmissionsRank
          TotalGHGEmissionsPercentileRank
          ElectricityUse
          ElectricityUseRank
          ElectricityUsePercentileRank
          NaturalGasUse
          NaturalGasUseRank
          DistrictSteamUse
          NaturalGasUsePercentileRank
          AvgPercentileLetterGrade
          DataAnomalies
        }
      }
    }
  }
</static-query>

<template>
  <DefaultLayout main-class="layout -full-width">
    <BuildingsHero
      :buildings="$static.allBuilding.edges.map((edge) => edge.node)"
    >
      <h1 id="main-content" tabindex="-1">
        Top {{ $static.allBuilding.edges.length }} Buildings by Fossil Gas Use
      </h1>
    </BuildingsHero>

    <div class="page-constrained">
      <p class="constrained -wide">
        These buildings are the largest consumers of fossil gas (methane) in the
        city. Fossil gas in these buildings is typically used for heating gas
        and water, and since electrifying the grid won't clean up these
        emissions it's an important set of buildings to focus on!
      </p>

      <DataDisclaimer />

      <BuildingsTable
        :buildings="$static.allBuilding.edges"
        :show-gas-use="true"
      />

      <DataSourceFootnote />
    </div>
  </DefaultLayout>
</template>

<style lang="scss"></style>
